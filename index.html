<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Miqi AI - 免费AI智能PPT生成器</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header class="banner">
        <div class="banner-content">
            <img src="images/logo.png" alt="Miqi AI" class="logo" onerror="this.style.display='none'">
            <div class="version-badge">v3.1.0</div> <!-- ✅ 更新版本号 -->
            <p class="subtitle">💡 一句话生成顶级PPT | 完全免费 | 四层AI智能体</p>
            <div class="status-indicator">
                <span class="status-dot" id="statusDot"></span>
                <span class="status-text" id="statusText">连接中...</span>
            </div>
        </div>
    </header>

    <main class="container">
        <section class="card">
            <div class="card-header">
                <h2>📋 描述你的PPT需求</h2>
                <p class="tip">💡 越详细效果越好（主题、受众、风格、页数）</p>
            </div>
            <div class="card-body">
                <textarea id="userInput" class="input-textarea" 
                    placeholder="例如：做一个介绍AI发展史的PPT，包含市场数据表格，给大学生看，15页" 
                    rows="4"></textarea>
                
                <div class="templates">
                    <span class="templates-label">⚡ 快速模板：</span>
                    <button class="template-btn" data-template="做一个新产品发布会PPT，包含市场数据对比表格，给投资人看，15页">💼 产品发布</button>
                    <button class="template-btn" data-template="做一个创业融资路演PPT，包含收入增长数据图表，12页">🚀 创业路演</button>
                    <button class="template-btn" data-template="做公司2025年终总结，包含业绩对比表格，专业风格">📊 年终总结</button>
                    <button class="template-btn" data-template="给大学生做AI发展史教学PPT，要生动有趣，配图建议详细，15页">🎓 教学课件</button>
                </div>
            </div>
        </section>

        <button id="generateBtn" class="generate-btn">
            🎯 立即生成PPT（Miqi AI 四层智能体 + 配图 + 图表）
        </button>

        <section class="card">
            <div class="card-header">
                <h2>📊 生成进度</h2>
            </div>
            <div class="card-body">
                <div class="progress-bar">
                    <div id="progressFill" class="progress-fill"></div>
                </div>
                <div class="progress-info">
                    <span id="progressIcon">⏸️</span>
                    <span id="progressText">等待输入...</span>
                    <span id="progressPercent">0%</span>
                </div>
            </div>
        </section>

        <section class="card preview-card">
            <div class="card-header">
                <h2>📄 生成预览</h2>
                <div class="toolbar">
                    <span id="fileInfo" class="file-info">未生成</span>
                    <div class="toolbar-buttons">
                        <!-- ✅ 按钮保留，由 JS 控制启用/禁用 -->
                        <button id="copyBtn" class="toolbar-btn" disabled>📋 复制</button>
                        <button id="downloadMdBtn" class="toolbar-btn" disabled>💾 下载MD</button>
                        <button id="downloadPptxBtn" class="toolbar-btn pptx-btn" disabled>🎯 下载PPTX</button>
                    </div>
                </div>
            </div>
            <div class="card-body">
                <pre id="outputPreview" class="output-preview">等待生成...</pre>
            </div>
        </section>
    </main>

    <footer class="footer">
        <div class="footer-content">
            <div class="footer-left">
                <button class="footer-btn" onclick="location.reload()">🔄 刷新</button>
                <button class="footer-btn" onclick="clearAll()">🗑️ 清空</button>
            </div>
            <div class="footer-right">
                <button class="footer-btn" onclick="showAbout()">ℹ️ 关于</button>
                <button class="footer-btn" onclick="showHelp()">❓ 帮助</button>
            </div>
        </div>
        <div class="developer-info">💝 蕊蕊是乔麦的小宝贝</div>
    </footer>

    <div id="modal" class="modal">
        <div class="modal-content">
            <span class="modal-close" onclick="closeModal()">&times;</span>
            <div id="modalBody"></div>
        </div>
    </div>

    <!-- ✅ 明确 API 地址（确保与后端一致） -->
    <script>
        // 后端 FastAPI 地址（无状态内存版）
        const API_BASE_URL = 'https://web-production-73c85.up.railway.app';
    </script>
    <script src="main.js"></script>
</body>
</html>